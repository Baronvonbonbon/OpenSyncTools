{"version":3,"file":"models.js","sourceRoot":"","sources":["../../src/project/models.ts"],"names":[],"mappings":"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","sourcesContent":["// // Copyright 2020-2025 SubQuery Pte Ltd authors & contributors\n// SPDX-License-Identifier: GPL-3.0\n\nimport {BaseDataSource, ProcessorImpl} from '@subql/common';\nimport {FileReference, Processor} from '@subql/types-core';\nimport {\n  CosmosEventFilter,\n  CosmosHandlerKind,\n  CosmosCustomHandler,\n  CosmosMapping,\n  CosmosHandler,\n  CosmosRuntimeHandler,\n  CosmosRuntimeDatasource,\n  CosmosDatasourceKind,\n  CosmosCustomDatasource,\n  CustomDataSourceAsset,\n  CosmosBlockFilter,\n  CosmosBlockHandler,\n  CosmosEventHandler,\n  CosmosMessageFilter,\n  CosmosTransactionHandler,\n  CosmosMessageHandler,\n  CustomModule,\n  CosmosTxFilter,\n} from '@subql/types-cosmos';\nimport {plainToClass, Transform, Type} from 'class-transformer';\nimport {\n  IsArray,\n  IsEnum,\n  IsInt,\n  IsOptional,\n  IsString,\n  IsObject,\n  ValidateNested,\n  ValidateIf,\n  IsBoolean,\n  Validate,\n} from 'class-validator';\nimport {FileReferenceImp} from './utils';\n\nexport class BlockFilter implements CosmosBlockFilter {\n  @IsOptional()\n  @IsInt()\n  modulo?: number;\n  @IsOptional()\n  @IsString()\n  timestamp?: string;\n}\n\nexport class TxFilter implements CosmosTxFilter {\n  @IsOptional()\n  @IsBoolean()\n  includeFailedTx?: boolean;\n}\n\nexport class MessageFilter extends TxFilter implements CosmosMessageFilter {\n  @IsString()\n  type!: string;\n  @IsOptional()\n  @IsObject()\n  values?: {[key: string]: string};\n  @ValidateIf((o) => o.type === '/cosmwasm.wasm.v1.MsgExecuteContract')\n  @IsOptional()\n  @IsString()\n  contractCall?: string;\n}\n\nexport class EventFilter implements CosmosEventFilter {\n  @IsString()\n  type!: string;\n  @IsOptional()\n  @Type(() => MessageFilter)\n  messageFilter?: CosmosMessageFilter;\n  @IsOptional()\n  @IsObject()\n  attributes?: Record<string, string | number>;\n}\n\nexport class BlockHandler implements CosmosBlockHandler {\n  @IsEnum(CosmosHandlerKind, {groups: [CosmosHandlerKind.Block]})\n  kind!: CosmosHandlerKind.Block;\n  @IsString()\n  handler!: string;\n  @IsOptional()\n  @Type(() => BlockFilter)\n  filter?: CosmosBlockFilter;\n}\n\nexport class TransactionHandler implements CosmosTransactionHandler {\n  @IsEnum(CosmosHandlerKind, {groups: [CosmosHandlerKind.Transaction]})\n  kind!: CosmosHandlerKind.Transaction;\n  @IsString()\n  handler!: string;\n}\n\nexport class MessageHandler implements CosmosMessageHandler {\n  @IsEnum(CosmosHandlerKind, {groups: [CosmosHandlerKind.Message]})\n  kind!: CosmosHandlerKind.Message;\n  @IsString()\n  handler!: string;\n  @IsOptional()\n  @ValidateNested()\n  @Type(() => MessageFilter)\n  filter?: CosmosMessageFilter;\n}\n\nexport class EventHandler implements CosmosEventHandler {\n  @IsOptional()\n  @ValidateNested()\n  @Type(() => EventFilter)\n  filter?: CosmosEventFilter;\n  @IsEnum(CosmosHandlerKind, {groups: [CosmosHandlerKind.Event]})\n  kind!: CosmosHandlerKind.Event;\n  @IsString()\n  handler!: string;\n}\n\nexport class CustomHandler implements CosmosCustomHandler {\n  @IsString()\n  kind!: string;\n  @IsString()\n  handler!: string;\n  @IsObject()\n  @IsOptional()\n  filter?: Record<string, unknown>;\n}\n\nexport class RuntimeMapping implements CosmosMapping {\n  @Transform((params) => {\n    const handlers: CosmosHandler[] = params.value;\n    return handlers.map((handler) => {\n      switch (handler.kind) {\n        case CosmosHandlerKind.Event:\n          return plainToClass(EventHandler, handler);\n        case CosmosHandlerKind.Message:\n          return plainToClass(MessageHandler, handler);\n        case CosmosHandlerKind.Transaction:\n          return plainToClass(TransactionHandler, handler);\n        case CosmosHandlerKind.Block:\n          return plainToClass(BlockHandler, handler);\n        default:\n          throw new Error(`handler ${(handler as any).kind} not supported`);\n      }\n    });\n  })\n  @IsArray()\n  @ValidateNested()\n  handlers!: CosmosHandler[];\n  @IsString()\n  file!: string;\n}\n\nexport class CustomMapping implements CosmosMapping<CosmosCustomHandler> {\n  @IsArray()\n  @Type(() => CustomHandler)\n  @ValidateNested()\n  handlers!: CosmosCustomHandler[];\n  @IsString()\n  file!: string;\n}\n\nexport class CosmosProcessorOptions implements CosmosProcessorOptions {\n  @IsOptional()\n  @IsString()\n  abi?: string;\n}\n\nexport class CosmosRuntimeDataSourceBase<M extends CosmosMapping<CosmosRuntimeHandler>>\n  extends BaseDataSource\n  implements CosmosRuntimeDatasource<M>\n{\n  @IsEnum(CosmosDatasourceKind, {groups: [CosmosDatasourceKind.Runtime]})\n  kind!: CosmosDatasourceKind.Runtime;\n  @Type(() => RuntimeMapping)\n  @ValidateNested()\n  mapping!: M;\n  @IsOptional()\n  @Validate(FileReferenceImp)\n  assets?: Map<string, FileReference>;\n  @IsOptional()\n  @Type(() => CosmosProcessorOptions)\n  @ValidateNested()\n  options?: CosmosProcessorOptions;\n}\n\nexport class CosmosFileReferenceImpl implements FileReference {\n  @IsString()\n  file!: string;\n}\n\nexport class CosmosCustomModuleImpl implements CustomModule {\n  @IsString()\n  file!: string;\n  @IsArray()\n  @Type(() => String)\n  messages!: string[];\n}\n\nexport class CosmosCustomDataSourceBase<\n    K extends string,\n    M extends CosmosMapping = CosmosMapping<CosmosCustomHandler>,\n    O = any\n  >\n  extends BaseDataSource\n  implements CosmosCustomDatasource<K, M, O>\n{\n  @IsString()\n  kind!: K;\n  @Type(() => CustomMapping)\n  @ValidateNested()\n  mapping!: M;\n  @Type(() => CosmosFileReferenceImpl)\n  @ValidateNested({each: true})\n  assets!: Map<string, CustomDataSourceAsset>;\n  @Type(() => ProcessorImpl)\n  @IsObject()\n  processor!: Processor<O>;\n}\n"]}
{"version":3,"file":"model.js","sourceRoot":"","sources":["../../../../src/project/versioned/v1_0_0/model.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2020-2025 SubQuery Pte Ltd authors & contributors\n// SPDX-License-Identifier: GPL-3.0\n\nimport {\n  BaseDeploymentV1_0_0,\n  CommonProjectNetworkV1_0_0,\n  FileType,\n  ParentProjectModel,\n  ProjectManifestBaseImpl,\n  RunnerNodeImpl,\n  RunnerQueryBaseModel,\n  validateObject,\n} from '@subql/common';\nimport {BaseMapping, NodeSpec, ParentProject, QuerySpec, RunnerSpecs} from '@subql/types-core';\nimport {\n  CustomDatasourceTemplate,\n  NearCustomDatasource,\n  NearProjectManifestV1_0_0,\n  NearRuntimeDatasource,\n  RuntimeDatasourceTemplate,\n} from '@subql/types-near';\nimport {plainToClass, Transform, TransformFnParams, Type} from 'class-transformer';\nimport {Equals, IsArray, IsNotEmpty, IsObject, IsOptional, IsString, ValidateNested} from 'class-validator';\nimport {CustomDataSourceBase, RuntimeDataSourceBase} from '../../models';\n\nconst NEAR_NODE_NAME = `@subql/node-near`;\n\nexport class NearRunnerNodeImpl extends RunnerNodeImpl {\n  @Equals(NEAR_NODE_NAME, {message: `Runner Near node name incorrect, suppose be '${NEAR_NODE_NAME}'`})\n  name: string = NEAR_NODE_NAME;\n}\n\nexport class NearRuntimeDataSourceImpl extends RuntimeDataSourceBase implements NearRuntimeDatasource {\n  validate(): void {\n    return validateObject(this, 'failed to validate runtime datasource.');\n  }\n}\n\nexport class NearCustomDataSourceImpl<K extends string = string, M extends BaseMapping<any> = BaseMapping<any>>\n  extends CustomDataSourceBase<K, M>\n  implements NearCustomDatasource<K, M>\n{\n  validate(): void {\n    return validateObject(this, 'failed to validate custom datasource.');\n  }\n}\n\nexport class RuntimeDatasourceTemplateImpl extends NearRuntimeDataSourceImpl implements RuntimeDatasourceTemplate {\n  @IsString()\n  name!: string;\n}\n\nexport class CustomDatasourceTemplateImpl extends NearCustomDataSourceImpl implements CustomDatasourceTemplate {\n  @IsString()\n  name!: string;\n}\n\nexport class NearRunnerSpecsImpl implements RunnerSpecs {\n  @IsObject()\n  @ValidateNested()\n  @Type(() => NearRunnerNodeImpl)\n  node!: NodeSpec;\n  @IsObject()\n  @ValidateNested()\n  @Type(() => RunnerQueryBaseModel)\n  query!: QuerySpec;\n}\n\nexport class ProjectNetworkDeploymentV1_0_0 {\n  @IsNotEmpty()\n  @Transform(({value}: TransformFnParams) => value.trim())\n  @IsString()\n  chainId!: string;\n  @IsOptional()\n  @IsArray()\n  bypassBlocks?: (number | `${number}-${number}`)[];\n}\n\nexport class ProjectNetworkV1_0_0 extends CommonProjectNetworkV1_0_0<FileType> {\n  @ValidateNested()\n  @Type(() => FileType)\n  @IsOptional()\n  chaintypes?: FileType = undefined;\n}\n\nexport class DeploymentV1_0_0 extends BaseDeploymentV1_0_0 {\n  @Transform((params) => {\n    if (params.value.genesisHash && !params.value.chainId) {\n      params.value.chainId = params.value.genesisHash;\n    }\n    return plainToClass(ProjectNetworkDeploymentV1_0_0, params.value);\n  })\n  @ValidateNested()\n  @Type(() => ProjectNetworkDeploymentV1_0_0)\n  network!: ProjectNetworkDeploymentV1_0_0;\n\n  @IsObject()\n  @ValidateNested()\n  @Type(() => NearRunnerSpecsImpl)\n  runner!: RunnerSpecs;\n\n  @IsArray()\n  @ValidateNested()\n  @Type(() => NearCustomDataSourceImpl, {\n    discriminator: {\n      property: 'kind',\n      subTypes: [{value: NearRuntimeDataSourceImpl, name: 'near/Runtime'}],\n    },\n    keepDiscriminatorProperty: true,\n  })\n  dataSources!: (NearRuntimeDatasource | NearCustomDatasource)[];\n  @IsOptional()\n  @IsArray()\n  @ValidateNested()\n  @Type(() => CustomDatasourceTemplateImpl, {\n    discriminator: {\n      property: 'kind',\n      subTypes: [{value: RuntimeDatasourceTemplateImpl, name: 'near/Runtime'}],\n    },\n    keepDiscriminatorProperty: true,\n  })\n  templates?: (RuntimeDatasourceTemplate | CustomDatasourceTemplate)[];\n}\n\nexport class ProjectManifestV1_0_0Impl\n  extends ProjectManifestBaseImpl<DeploymentV1_0_0>\n  implements NearProjectManifestV1_0_0\n{\n  constructor() {\n    super(DeploymentV1_0_0);\n  }\n\n  @Equals('1.0.0')\n  specVersion = '1.0.0';\n  @Type(() => NearCustomDataSourceImpl, {\n    discriminator: {\n      property: 'kind',\n      subTypes: [{value: NearRuntimeDataSourceImpl, name: 'near/Runtime'}],\n    },\n    keepDiscriminatorProperty: true,\n  })\n  dataSources!: (NearRuntimeDatasource | NearCustomDatasource)[];\n  @Type(() => ProjectNetworkV1_0_0)\n  network!: ProjectNetworkV1_0_0;\n  @IsString()\n  name!: string;\n  @IsString()\n  version!: string;\n  @ValidateNested()\n  @Type(() => FileType)\n  schema!: FileType;\n  @IsOptional()\n  @IsArray()\n  @ValidateNested()\n  @Type(() => CustomDatasourceTemplateImpl, {\n    discriminator: {\n      property: 'kind',\n      subTypes: [{value: RuntimeDatasourceTemplateImpl, name: 'near/Runtime'}],\n    },\n    keepDiscriminatorProperty: true,\n  })\n  templates?: (RuntimeDatasourceTemplate | CustomDatasourceTemplate)[];\n  @IsObject()\n  @ValidateNested()\n  @Type(() => NearRunnerSpecsImpl)\n  runner!: RunnerSpecs;\n\n  @IsOptional()\n  @IsObject()\n  @Type(() => ParentProjectModel)\n  parent?: ParentProject;\n}\n"]}
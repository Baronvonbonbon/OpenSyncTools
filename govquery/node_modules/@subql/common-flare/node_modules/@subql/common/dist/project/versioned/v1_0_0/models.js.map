{"version":3,"file":"models.js","sourceRoot":"","sources":["../../../../src/project/versioned/v1_0_0/models.ts"],"names":[],"mappings":"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","sourcesContent":["// Copyright 2020-2024 SubQuery Pte Ltd authors & contributors\n// SPDX-License-Identifier: GPL-3.0\n\nimport {\n  BlockFilter,\n  CommonSubqueryProject,\n  IProjectNetworkConfig,\n  NodeOptions,\n  NodeSpec,\n  ParentProject,\n  QuerySpec,\n  RunnerSpecs,\n} from '@subql/types-core';\nimport {Transform, TransformFnParams, Type} from 'class-transformer';\nimport {\n  Equals,\n  IsBoolean,\n  IsNumber,\n  IsObject,\n  IsOptional,\n  IsString,\n  IsInt,\n  Validate,\n  ValidateNested,\n  IsArray,\n  IsNotEmpty,\n  Allow,\n  ValidateIf,\n} from 'class-validator';\nimport {SemverVersionValidator} from '../../utils';\nimport {FileType} from '../base';\n\nexport class RunnerQueryBaseModel implements QuerySpec {\n  @Equals('@subql/query')\n  name!: string;\n  @IsString()\n  @Validate(SemverVersionValidator)\n  // @Matches(RUNNER_REGEX)\n  version!: string;\n}\n\nexport class RunnerNodeImpl implements NodeSpec {\n  @IsString()\n  name!: string;\n  @IsString()\n  @Validate(SemverVersionValidator)\n  // @Matches(RUNNER_REGEX,{message: 'runner version is not correct'})\n  version!: string;\n  @IsOptional()\n  @IsObject()\n  @ValidateNested()\n  @Type(() => RunnerNodeOptionsModel)\n  options?: NodeOptions;\n}\n\nexport class RunnerNodeOptionsModel implements NodeOptions {\n  @IsOptional()\n  @IsBoolean()\n  historical?: boolean;\n  @IsOptional()\n  @IsBoolean()\n  unsafe?: boolean;\n  @IsOptional()\n  @IsBoolean()\n  unfinalizedBlocks?: boolean;\n  @IsOptional()\n  @IsBoolean()\n  skipTransactions?: boolean;\n}\n\nexport class BlockFilterImpl implements BlockFilter {\n  @IsOptional()\n  @IsInt()\n  modulo?: number;\n  @IsOptional()\n  @IsString()\n  timestamp?: string;\n}\n\nexport class ParentProjectModel implements ParentProject {\n  @IsNumber()\n  @ValidateIf((obj, value) => value !== null || obj.unitlBlock === null || obj.untilBlock === undefined)\n  block!: number;\n  @IsNumber()\n  @ValidateIf((obj, value) => value !== null || obj.block === null || obj.block === undefined)\n  untilBlock!: number;\n  @IsString()\n  reference!: string;\n}\n\n// Use for generic project validation only\nexport class CommonProjectManifestV1_0_0Impl<D extends object = any> implements CommonSubqueryProject {\n  @Allow()\n  definitions!: object;\n  @IsString()\n  @IsOptional()\n  description?: string;\n  @IsOptional()\n  @IsString()\n  repository?: string;\n  @Equals('1.0.0')\n  specVersion!: string;\n  // To be validated in specific manifest type\n  @IsArray()\n  dataSources!: any[];\n  @ValidateNested()\n  @Type(() => CommonProjectNetworkV1_0_0)\n  network!: IProjectNetworkConfig;\n  @IsString()\n  @IsOptional()\n  name?: string;\n  @IsString()\n  version!: string;\n  @ValidateNested()\n  @Type(() => FileType)\n  schema!: FileType;\n  @IsOptional()\n  @IsArray()\n  templates?: any[];\n  @IsObject()\n  @ValidateNested()\n  @Type(() => CommonRunnerSpecsImpl)\n  runner!: RunnerSpecs;\n  @IsOptional()\n  @IsObject()\n  @Type(() => ParentProjectModel)\n  parent?: ParentProject;\n  readonly deployment!: D;\n}\n\nexport class CommonRunnerSpecsImpl implements RunnerSpecs {\n  @IsObject()\n  @ValidateNested()\n  @Type(() => RunnerNodeImpl)\n  node!: NodeSpec;\n  @IsObject()\n  @ValidateNested()\n  @Type(() => RunnerQueryBaseModel)\n  query!: QuerySpec;\n}\n\nexport class CommonProjectNetworkV1_0_0<C = any> implements IProjectNetworkConfig {\n  @IsString({each: true})\n  @IsOptional()\n  endpoint!: string | string[];\n  @IsString({each: true})\n  @IsOptional()\n  dictionary!: string | string[];\n  @IsNotEmpty()\n  @Transform(({value}: TransformFnParams) => value.trim())\n  @IsString()\n  chainId!: string;\n  @IsOptional()\n  chaintypes?: C; // ensure lowercase to keep consistency\n  @IsOptional()\n  @IsArray()\n  bypassBlocks?: (number | `${number}-${number}`)[];\n}\n"]}